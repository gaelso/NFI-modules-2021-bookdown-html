<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Sampling | Interactive training modules on National Forest Inventory data analysis</title>
  <meta name="description" content="2 Sampling | Interactive training modules on National Forest Inventory data analysis" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Sampling | Interactive training modules on National Forest Inventory data analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Sampling | Interactive training modules on National Forest Inventory data analysis" />
  
  
  

<meta name="author" content="Handbook with solutions" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="newland.html"/>
<link rel="next" href="collect.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html"><b>Interactive training modules on NFI</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover page</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="0.1" data-path="foreword.html"><a href="foreword.html#r-packages-list"><i class="fa fa-check"></i><b>0.1</b> R packages list</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#an-interactive-module-to-practice-sampling-and-carbon-stock-calculations"><i class="fa fa-check"></i>An interactive module to practice sampling and carbon stock calculations</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="newland.html"><a href="newland.html"><i class="fa fa-check"></i><b>1</b> A new land has emerged</a>
<ul>
<li class="chapter" data-level="1.1" data-path="newland.html"><a href="newland.html#first-look"><i class="fa fa-check"></i><b>1.1</b> First look</a></li>
<li class="chapter" data-level="1.2" data-path="newland.html"><a href="newland.html#preliminary-information"><i class="fa fa-check"></i><b>1.2</b> Preliminary information</a>
<ul>
<li class="chapter" data-level="" data-path="newland.html"><a href="newland.html#results-of-a-small-scale-forest-inventory"><i class="fa fa-check"></i>Results of a small scale forest inventory</a></li>
<li class="chapter" data-level="" data-path="newland.html"><a href="newland.html#land-cover-types-and-areas"><i class="fa fa-check"></i>land cover types and areas</a></li>
<li class="chapter" data-level="" data-path="newland.html"><a href="newland.html#bonus"><i class="fa fa-check"></i>Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>2</b> Sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sampling.html"><a href="sampling.html#number-of-random-samples"><i class="fa fa-check"></i><b>2.1</b> Number of random samples</a>
<ul>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#nfi-main-variable"><i class="fa fa-check"></i>NFI main variable</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#indicative-variability"><i class="fa fa-check"></i>Indicative variability</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#systematic-sampling-design"><i class="fa fa-check"></i>Systematic sampling design</a>
<ul>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#the-4-km-grid"><i class="fa fa-check"></i>The 4 km grid</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#the-3-km-grid"><i class="fa fa-check"></i>The 3 km grid</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#the-2-km-grid"><i class="fa fa-check"></i>The 2 km grid</a></li>
<li class="chapter" data-level="" data-path="sampling.html"><a href="sampling.html#recap"><i class="fa fa-check"></i>Recap</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sampling.html"><a href="sampling.html#random-sampling"><i class="fa fa-check"></i><b>2.2</b> Random Sampling</a></li>
<li class="chapter" data-level="2.3" data-path="sampling.html"><a href="sampling.html#uneven-systematic-sampling"><i class="fa fa-check"></i><b>2.3</b> Uneven Systematic Sampling</a></li>
<li class="chapter" data-level="2.4" data-path="sampling.html"><a href="sampling.html#plot-designs"><i class="fa fa-check"></i><b>2.4</b> Plot designs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="collect.html"><a href="collect.html"><i class="fa fa-check"></i><b>3</b> Data collection and processing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="collect.html"><a href="collect.html#planification"><i class="fa fa-check"></i><b>3.1</b> Planification</a></li>
<li class="chapter" data-level="3.2" data-path="collect.html"><a href="collect.html#field-work-results-provided"><i class="fa fa-check"></i><b>3.2</b> Field work results provided</a></li>
<li class="chapter" data-level="3.3" data-path="collect.html"><a href="collect.html#plots-not-accessible"><i class="fa fa-check"></i><b>3.3</b> Plots not accessible</a></li>
<li class="chapter" data-level="3.4" data-path="collect.html"><a href="collect.html#data-processing"><i class="fa fa-check"></i><b>3.4</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clean.html"><a href="clean.html"><i class="fa fa-check"></i><b>4</b> Data cleaning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="clean.html"><a href="clean.html#visualizations"><i class="fa fa-check"></i><b>4.1</b> Visualizations</a></li>
<li class="chapter" data-level="4.2" data-path="clean.html"><a href="clean.html#corrections"><i class="fa fa-check"></i><b>4.2</b> Corrections</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="clean.html"><a href="clean.html#diameter-and-height"><i class="fa fa-check"></i><b>4.2.1</b> Diameter and height</a></li>
<li class="chapter" data-level="4.2.2" data-path="clean.html"><a href="clean.html#tree-location"><i class="fa fa-check"></i><b>4.2.2</b> Tree location</a></li>
<li class="chapter" data-level="4.2.3" data-path="clean.html"><a href="clean.html#species-list"><i class="fa fa-check"></i><b>4.2.3</b> Species list</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cstock.html"><a href="cstock.html"><i class="fa fa-check"></i><b>5</b> Calculating the new land’s forest carbon stock</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cstock.html"><a href="cstock.html#ancillary-data"><i class="fa fa-check"></i><b>5.1</b> Ancillary data</a></li>
<li class="chapter" data-level="5.2" data-path="cstock.html"><a href="cstock.html#allometric-equations"><i class="fa fa-check"></i><b>5.2</b> Allometric equations</a></li>
<li class="chapter" data-level="5.3" data-path="cstock.html"><a href="cstock.html#tree-carbon"><i class="fa fa-check"></i><b>5.3</b> Tree carbon</a></li>
<li class="chapter" data-level="5.4" data-path="cstock.html"><a href="cstock.html#plot-carbon"><i class="fa fa-check"></i><b>5.4</b> Plot carbon</a></li>
<li class="chapter" data-level="5.5" data-path="cstock.html"><a href="cstock.html#forest-level"><i class="fa fa-check"></i><b>5.5</b> Forest level</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive training modules on National Forest Inventory data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Sampling</h1>
<div id="number-of-random-samples" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Number of random samples</h2>
<div id="nfi-main-variable" class="section level3 unnumbered">
<h3>NFI main variable</h3>
<p>In this interactive module the main variable of interest is the forest <txt-green>mean aboveground biomass</txt-green>. In this version we will limit ourselves to random and systematic samples, but with post stratification we will also get an aboveground biomass estimates for each forest type.</p>
<div class="infobox">
<p>In the next version of the interactive module, additional key variables of interest will be presented, such as biodiversity (Shannon index, Importance Value Index) and commercial volume.</p>
</div>
</div>
<div id="indicative-variability" class="section level3 unnumbered">
<h3>Indicative variability</h3>
<p>Remember in the NFI module lesson 3, the formula to estimate the <strong>sampling size <code>n</code></strong> is:</p>
<p><span class="math display">\[n = \left(\frac{CV \cdot t^{1 - \alpha/2}_{n-1}}{A}\right)^2 \sim \left(\frac{CV \cdot 1.96}{A}\right)^2\]</span>
with <span class="math inline">\(CV = \mu / \sigma\)</span> the NFI main variable coefficient of variation in percentage (i.e. average <span class="math inline">\(\mu\)</span> divided by standard deviation <span class="math inline">\(\sigma\)</span> * 100), <span class="math inline">\(A\)</span> the desired precision in percentage and <span class="math inline">\(t^{1 - \alpha/2}_{n-1}\)</span> the Student t-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom and <span class="math inline">\(1-\frac{\alpha}{2}\)</span> confidence which is approximated by the value 1.96 .</p>
<p> </p>
<p>Thanks to <code>fi_agb</code>, the results of the preliminary forest inventory, we have an estimate of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> for a forest stand in ``Louland. While this stand is most likely not representative of the whole island, we can use it to make an estimate of the number of samples necessary to achieve various target precision values. The final number of plots will depend on the desired precision and your budget constraints. In case of a systematic sampling we can add an additional constraint that we want the NFI grid to be a round km value.</p>
<p>Let’s first calculate the number of sample for different precision levels. For a 5% precision, the number of sample is:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sampling.html#cb15-1" aria-hidden="true" tabindex="-1"></a>n05 <span class="ot">&lt;-</span> ((fi_agb<span class="sc">$</span>mean_agb <span class="sc">/</span> fi_agb<span class="sc">$</span>sd_agb) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">/</span> <span class="fl">0.05</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb15-2"><a href="sampling.html#cb15-2" aria-hidden="true" tabindex="-1"></a>n05</span></code></pre></div>
<pre class="Rout"><code>[1] 1707.872</code></pre>
<p> </p>
<p><strong>Your turn, calculate <code>n10</code>, <code>n15</code> and <code>n20</code>, the number of samples necessary to get respectively 10%, 15% and 20% precision on <code>Louland</code>’s mean aboveground biomass.</strong></p>
<p>Calculations for 10% here:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sampling.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb17-2"><a href="sampling.html#cb17-2" aria-hidden="true" tabindex="-1"></a>n10 <span class="ot">&lt;-</span> ((fi_agb<span class="sc">$</span>mean_agb <span class="sc">/</span> fi_agb<span class="sc">$</span>sd_agb) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">/</span> <span class="fl">0.1</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-3"><a href="sampling.html#cb17-3" aria-hidden="true" tabindex="-1"></a>n10</span></code></pre></div>
<pre class="Rout"><code>[1] 426.968</code></pre>
<p> </p>
<p>Calculations for 15% here:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sampling.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb19-2"><a href="sampling.html#cb19-2" aria-hidden="true" tabindex="-1"></a>n15 <span class="ot">&lt;-</span> ((fi_agb<span class="sc">$</span>mean_agb <span class="sc">/</span> fi_agb<span class="sc">$</span>sd_agb) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">/</span> <span class="fl">0.15</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb19-3"><a href="sampling.html#cb19-3" aria-hidden="true" tabindex="-1"></a>n15</span></code></pre></div>
<pre class="Rout"><code>[1] 189.7635</code></pre>
<p> </p>
<p>Calculations for 20% here:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sampling.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb21-2"><a href="sampling.html#cb21-2" aria-hidden="true" tabindex="-1"></a>n20 <span class="ot">&lt;-</span> ((fi_agb<span class="sc">$</span>mean_agb <span class="sc">/</span> fi_agb<span class="sc">$</span>sd_agb) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">/</span> <span class="fl">0.2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-3"><a href="sampling.html#cb21-3" aria-hidden="true" tabindex="-1"></a>n20</span></code></pre></div>
<pre class="Rout"><code>[1] 106.742</code></pre>
<p>Well done! We have enough budget for around 600 plots. What is the best range of precision we can afford?</p>
<div class="question">
<p><em>Multiple choices</em></p>
<ol style="list-style-type: decimal">
<li><strong>5% - 10%</strong></li>
<li>10% - 15%</li>
<li>15% - 20%</li>
</ol>
</div>
<p> </p>
</div>
</div>
<div id="systematic-sampling-design" class="section level2 unnumbered">
<h2>Systematic sampling design</h2>
<p>Now let’s see what sampling grid spacing this would lead to.</p>
<p>To get the exact number of samples (at least according to our preliminary data, some forest plot may very well be non forest on the ground), we will start from a <strong>systematic sampling design</strong>. This way we can account for the additional constraint on grid spacing, and afterwards we will make a simple random sampling that matches the same number of plots.</p>
<p>The <code>sf</code> package contains the function <code>st_make_grid()</code> to create random and grid points within an existing polygon. The new land fits more or less in a 90 km square, meaning that if we were to place a sampling plot at the center of each square of a 1 km grid we would have 90 * 90 = <code>8100</code> sampling plots. Similarly a 4 km grid would give us approximately (90 / 4)^2 = <code>506.25</code> plots. This is close to the number of plots for 10% precision on AGB so we will start there.</p>
<div id="the-4-km-grid" class="section level3 unnumbered">
<h3>The 4 km grid</h3>
<p>Let’s make the grid. We have the <code>sf_admin</code> shapefile that contains the administrative boundary of <code>Louland</code> and can be used as a canvas for the grid.</p>
<div class="infobox">
<p>We will also offset the grid starting point 1 km South and 1 km West of the land most Southern and Western point to avoid have too many plots at the edge of the land. This is a precaution specific for this exercise and may not be needed in a real country! The <code>offset</code> is calculated based on the land cover shapefile bounding box.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sampling.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Might as well be hidden</span></span>
<span id="cb23-2"><a href="sampling.html#cb23-2" aria-hidden="true" tabindex="-1"></a>offset <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sf_lc)[<span class="fu">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;ymin&quot;</span>)] <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1000</span>)</span></code></pre></div>
</div>
<p>To make the grid we use the option <code>what = "polygon"</code>…</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sampling.html#cb24-1" aria-hidden="true" tabindex="-1"></a>sf_grid4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">4000</span>), <span class="at">what =</span> <span class="st">&quot;polygons&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="sampling.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin)</span></code></pre></div>
<p> </p>
<p>… And to make points we change the option to <code>what = "center"</code> (replace <code>"center"</code> with <code>"corner"</code> to have the point at the grid intersections).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sampling.html#cb25-1" aria-hidden="true" tabindex="-1"></a>sf_points4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">4000</span>), <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="sampling.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="sampling.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
<p>Finally, we can extract the land cover information at each plot location with <code>st_intersection()</code>…</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sampling.html#cb26-1" aria-hidden="true" tabindex="-1"></a>sf_plot4 <span class="ot">&lt;-</span> sf_points4 <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="sampling.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="sampling.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="sampling.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p>… And visualize the grid with the following code (we have a custom color palette <code>pal</code> for <code>Louland</code> land covers).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sampling.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-2"><a href="sampling.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="sampling.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot4, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="sampling.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_grid4, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="sampling.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_sf(data = sf_admin, fill = NA, size = 1.2) +</span></span>
<span id="cb27-6"><a href="sampling.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb27-7"><a href="sampling.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="sampling.html#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/ggplot4-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>Looking good! To calculate the number of plot in each forest type and the total we can use <code>group_by()</code> and <code>summarise()</code> again.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sampling.html#cb28-1" aria-hidden="true" tabindex="-1"></a>nplot4 <span class="ot">&lt;-</span> sf_plot4 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="sampling.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="sampling.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="sampling.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb28-5"><a href="sampling.html#cb28-5" aria-hidden="true" tabindex="-1"></a>nplot4 </span></code></pre></div>
<pre class="Rout"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        3
2 NF      102
3 PL       93
4 DD       37
5 MD      129
6 EV       54
7 MG        5</code></pre>
<p>We then need to remove non-forest categories with <code>filter()</code> and sum the remaining number of plots.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sampling.html#cb30-1" aria-hidden="true" tabindex="-1"></a>nplot4_total <span class="ot">&lt;-</span> nplot4 <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="sampling.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="sampling.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb30-4"><a href="sampling.html#cb30-4" aria-hidden="true" tabindex="-1"></a>nplot4_total</span></code></pre></div>
<pre class="Rout"><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1   318</code></pre>
<p> </p>
<p>While we can definitely afford this sampling size, we can intensify a bit to increase our precision. In our very first approximation we didn’t account for the fact that a good proportion of the land is non-forest.</p>
<p><strong>You turn! Prepare <code>sf_pointx</code>, <code>sf_plotx</code>, <code>nplotx</code> and <code>nplotx_total</code> with <code>x</code> taking the values 3 and 2 for creating respectively a 3 and 2 km grids.</strong></p>
<p> </p>
</div>
<div id="the-3-km-grid" class="section level3 unnumbered">
<h3>The 3 km grid</h3>
<p>Create directly:</p>
<ul>
<li>Points with the option <code>what = "center"</code>, this time the <code>cellsize</code> argument will be 3000 m.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sampling.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb32-2"><a href="sampling.html#cb32-2" aria-hidden="true" tabindex="-1"></a>sf_points3 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">3000</span>, <span class="dv">3000</span>), <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="sampling.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="sampling.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<ul>
<li>Plots by joining the land cover shapefile <code>sf_newland</code>.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sampling.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb33-2"><a href="sampling.html#cb33-2" aria-hidden="true" tabindex="-1"></a>sf_plot3 <span class="ot">&lt;-</span> sf_points3 <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="sampling.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="sampling.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="sampling.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p> </p>
<ul>
<li>A map with the plots over the land cover (remember we have a custom color palette <code>newland_palette</code> for <code>Louland</code> land covers).</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sampling.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb34-2"><a href="sampling.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-3"><a href="sampling.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="sampling.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot3, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="sampling.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb34-6"><a href="sampling.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="sampling.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/ggplot3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
<ul>
<li>Calculations of the number of plots per land cover class.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sampling.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb35-2"><a href="sampling.html#cb35-2" aria-hidden="true" tabindex="-1"></a>nplot3 <span class="ot">&lt;-</span> sf_plot3 <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="sampling.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="sampling.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="sampling.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb35-6"><a href="sampling.html#cb35-6" aria-hidden="true" tabindex="-1"></a>nplot3 </span></code></pre></div>
<pre class="Rout"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        6
2 NF      179
3 PL      166
4 DD       77
5 MD      199
6 EV      106
7 MG        5</code></pre>
<ul>
<li>And the total number of plot in forests.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sampling.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb37-2"><a href="sampling.html#cb37-2" aria-hidden="true" tabindex="-1"></a>nplot3_total <span class="ot">&lt;-</span> nplot3 <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="sampling.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="sampling.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb37-5"><a href="sampling.html#cb37-5" aria-hidden="true" tabindex="-1"></a>nplot3_total</span></code></pre></div>
<pre class="Rout"><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1   553</code></pre>
<p>Good job! The 3 km grid looks like exactly what we need. Let’s still design a 2 km grid to see if we could afford it.</p>
<p> </p>
</div>
<div id="the-2-km-grid" class="section level3 unnumbered">
<h3>The 2 km grid</h3>
<p>Create directly:</p>
<ul>
<li>Points with the option <code>what = "center"</code>.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sampling.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb39-2"><a href="sampling.html#cb39-2" aria-hidden="true" tabindex="-1"></a>sf_points2 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2000</span>), <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="sampling.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="sampling.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<ul>
<li>Plots by joining the land cover shapefile <code>sf_newland</code>.</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sampling.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb40-2"><a href="sampling.html#cb40-2" aria-hidden="true" tabindex="-1"></a>sf_plot2 <span class="ot">&lt;-</span> sf_points2 <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="sampling.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="sampling.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="sampling.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p> </p>
<ul>
<li>A map with the plots over the land cover (remember we have a custom color palette <code>newland_palette</code> for <code>Louland</code> land covers).</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sampling.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb41-2"><a href="sampling.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a href="sampling.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="sampling.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot2, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="sampling.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb41-6"><a href="sampling.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="sampling.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/ggplot2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
<ul>
<li>Calculations of the number of plots per land cover class.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sampling.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb42-2"><a href="sampling.html#cb42-2" aria-hidden="true" tabindex="-1"></a>nplot2 <span class="ot">&lt;-</span> sf_plot2 <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="sampling.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="sampling.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="sampling.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb42-6"><a href="sampling.html#cb42-6" aria-hidden="true" tabindex="-1"></a>nplot2 </span></code></pre></div>
<pre class="Rout"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA       10
2 NF      390
3 PL      375
4 DD      166
5 MD      462
6 EV      215
7 MG       30</code></pre>
<ul>
<li>And the total number of plot in forests.</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sampling.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb44-2"><a href="sampling.html#cb44-2" aria-hidden="true" tabindex="-1"></a>nplot2_total <span class="ot">&lt;-</span> nplot2 <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="sampling.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="sampling.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb44-5"><a href="sampling.html#cb44-5" aria-hidden="true" tabindex="-1"></a>nplot2_total</span></code></pre></div>
<pre class="Rout"><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1  1248</code></pre>
<p> </p>
<div class="question">
<p><strong>ADD exercise: what grid to select</strong></p>
</div>
<p>Good job! The 2 km grid is outside our budget constraint so we will continue with the 3 km grid!</p>
<p> </p>
</div>
<div id="recap" class="section level3 unnumbered">
<h3>Recap</h3>
<p>Based on the preliminary inventory and few R skills, we have now identified a good sampling grid. To recap the process was:</p>
<ol style="list-style-type: decimal">
<li>We used the <strong>preliminary forest inventory</strong> results to calculate a an hypothetical number of samples required for a desired precision of 5, 10, 15 or 20%.</li>
<li>Based on our available budget we have identified a suitable range of <strong>sampling sizes</strong>.</li>
<li>We have then created different <strong>sampling grids</strong> to <code>Louland</code> and estimated how many plots would fall on forest land.</li>
<li>We have selected the most adequate sampling grid based on our <strong>budget/precision trade-off</strong>.</li>
</ol>
<p><txt-green> Now let’s see what the same amount of sampling points would give us with a random sampling or with an uneven systematic sampling.</txt-green></p>
<p> </p>
</div>
</div>
<div id="random-sampling" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Random Sampling</h2>
<p>Complete random sampling designs have a number of disadvantages and are generally not recommended at national scale. We will still relocate our <code>553</code> plots randomly to compare different sampling designs and demonstrate their pros and cons.</p>
<p>The equivalent of <code>st_make_grid()</code> for random sampling is <code>st_sample()</code>. Every time <code>st_sample()</code> is used a new set of random locations are created. To get the same random allocation every time we need to set the random selection with a seed and the function <code>set.seed()</code>. In the example we will uise <code>set.seed(36)</code> but feel free to change or remove the function in the practice below.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sampling.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb46-2"><a href="sampling.html#cb46-2" aria-hidden="true" tabindex="-1"></a>sf_points_rd <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(<span class="at">x =</span> sf_lc, <span class="at">size =</span> nplot3_total<span class="sc">$</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="sampling.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
<p>We can then extract the land cover at the plots’ location…</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sampling.html#cb47-1" aria-hidden="true" tabindex="-1"></a>sf_plot_rd <span class="ot">&lt;-</span> sf_points_rd <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="sampling.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="sampling.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="sampling.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p>… And map them.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sampling.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb48-2"><a href="sampling.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="sampling.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot_rd, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="sampling.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb48-5"><a href="sampling.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="sampling.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/simp-map-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
<p>If at a first glance the plot distribution shows a decent coverage of the new land, the interesting part is the calculation of the number of ploot pooer land cover category.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sampling.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb49-2"><a href="sampling.html#cb49-2" aria-hidden="true" tabindex="-1"></a>nplot_rd <span class="ot">&lt;-</span> sf_plot_rd <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="sampling.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="sampling.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="sampling.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb49-6"><a href="sampling.html#cb49-6" aria-hidden="true" tabindex="-1"></a>nplot_rd</span></code></pre></div>
<pre class="Rout"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        1
2 NF      126
3 PL      132
4 DD       57
5 MD      151
6 EV       78
7 MG        8</code></pre>
<p> </p>
<p><strong>Practice time! in the console windows below, test different seed numbers and visualize the results.</strong></p>
<ul>
<li>Create the points:</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sampling.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb51-2"><a href="sampling.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">36</span>)</span>
<span id="cb51-3"><a href="sampling.html#cb51-3" aria-hidden="true" tabindex="-1"></a>sf_points_practice <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(<span class="at">x =</span> sf_lc, <span class="at">size =</span> nplot3_total<span class="sc">$</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="sampling.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<ul>
<li>Add the land cover information:</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sampling.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Guided</span></span>
<span id="cb52-2"><a href="sampling.html#cb52-2" aria-hidden="true" tabindex="-1"></a>sf_plot_practice <span class="ot">&lt;-</span> sf_points_practice <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="sampling.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="sampling.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="sampling.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p> </p>
<ul>
<li>Show the plot locations on a map:</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="sampling.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-2"><a href="sampling.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="sampling.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot_practice, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="sampling.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb53-5"><a href="sampling.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="sampling.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/prac-map-1.png" width="80%" style="display: block; margin: auto;" /></p>
<ul>
<li>Calculate the number of plots per land cover type:</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sampling.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Empty console</span></span>
<span id="cb54-2"><a href="sampling.html#cb54-2" aria-hidden="true" tabindex="-1"></a>nplot_practice <span class="ot">&lt;-</span> sf_plot_practice <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="sampling.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="sampling.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="sampling.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb54-6"><a href="sampling.html#cb54-6" aria-hidden="true" tabindex="-1"></a>nplot_practice</span></code></pre></div>
<pre class="Rout"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        5
2 NF      137
3 PL      132
4 DD       63
5 MD      136
6 EV       71
7 MG        9</code></pre>
<p> </p>
</div>
<div id="uneven-systematic-sampling" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Uneven Systematic Sampling</h2>
<p><em>TBD</em></p>
</div>
<div id="plot-designs" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Plot designs</h2>
<p>In this version of the interactive module, the plot design is limited to one choice:</p>
<ul>
<li>circular plot of 20 m radius for all trees with a diameter at breast height bigger than orr equal to 20 cm,</li>
<li>nested circular plot of 5 m radius for trees with a diameter at breast height bigger than or equal to 10 cm and smaller than 20 cm.</li>
</ul>
<p>Let’s see for example all the trees measured in one plot: <code>"ev-ywt8"</code>.</p>
<p><img src="Handbook_files/figure-html/unnamed-chunk-1-1.png" width="80%" style="display: block; margin: auto;" /></p>

<div style="page-break-after: always;"></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="newland.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="collect.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
